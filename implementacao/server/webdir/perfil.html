<html>
<head>
    <meta content="no-store, no-cache, must-revalidate, Post-Check=0, Pre-Check=0" http-equiv="cache-control">
    <META CONTENT="no-cache" HTTP-EQUIV="pragma">
    <META CONTENT="-1" HTTP-EQUIV="expires">

    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>Jogo War</title>

    <!-- CSS only -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <!-- JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>

    <!-- Material-Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!---->

    <link href="css/variaveis.css?ver=3.0" rel="stylesheet">
    <link href="css/app.css?ver=3.0" rel="stylesheet">

    <!-- Bagdes -->
    <link href="css/insignias_x40.css?ver=3.0" rel="stylesheet">
    <link href="css/insignias_x100.css?ver=3.0" rel="stylesheet">
    <!---->

    <!-- Doadores -->
    <link href="css/coroa.css?ver=3.0" rel="stylesheet">
    <!---->

    <link href="css/sala.css?ver=3.0" rel="stylesheet">
    <link href="css/war/cartas_objetivos.css?ver=3.0" rel="stylesheet">

    <style>
        body {
            background-image: url('imagens/bg-soldado.png');
            background-color: var(--color-brown);
            background-repeat: repeat;
            background-size: auto;
            font-family: var(--font-family-default);
        }
    </style>
    <link href="css/perfil.css?ver=3.0" rel="stylesheet">
</head>
<body>
<div class="jumbotron jumbotron-fluid header titulo_sessao">
    <div class="container">
        <!--        <h1 class="display-4">Como jogar e regras</h1>-->
        <!--        <p class="lead">Confira todas as regras do jogo, como distribuir suas tropas, atacar territórios e muito mais.</p>-->
        <div class="input-group">
            <input id="input_pesquisa" type="text" class="form-control" placeholder="Nome do jogador"
                   style="color: var(--color-dark-brown); font-family: var(--font-family-default); font-size: 20px;">
            <div class="input-group-append">
                <button class="btn" style="background: white; color: var(--color-dark-brown);" type="button"
                        onclick="perfil_procurar($('input_pesquisa').val());">
                    <i class="fa fa-search"></i>
                </button>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="perfil_container">
        <div class="perfil_container_img">
            <div id="jogador_insignia"></div>
        </div>
        <div class="perfil_container_cnt">
            <div id="jogador_doador" class="box_crown" title="Doador" style="visibility: hidden;"></div>
            <div id="jogador_nome" class="nome"></div>
            <div class="infos">
                <div class="info_item">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="48px" height="48px"
                         style="padding: 4px; stroke-width: 50px; stroke: white; fill: white;" x="0px" y="0px"
                         viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
                        <g><path d="M974.5,763.5c0,0-19-21.3-43.3-11.2c0,0-10.1,2.9-24.1,17.5l1.4-2.2l-93.3-94.5l52.8-53.7c0,0,31-32.2-13.2-80.5c-44.2-48.3-75.1-27.2-84.6-19.8c-9.5,7.4-45.4,44.2-45.4,44.2l-68.1-69.8l246.9-221.3c0,0,38-26.4,41.7-59c3.7-32.6,13.6-158.5,13.6-158.5s-1.7-28.9-27.7-28.5c-26,0.4-156.5,13.6-156.5,13.6s-26.4-1.7-59,35.9C683,113.3,500.4,318,500.4,318L276.8,67c0,0-16.5-28.1-76.8-31.4c-60.3-3.3-123.4-9.5-123.4-9.5s-33-0.8-32.2,33C45.2,93,55.9,211.1,55.9,211.1s9.9,34.7,73.5,91.6c63.6,57,212.2,189.1,212.2,189.1l-64.4,71l-41.5-41.5c0,0-32.8-31.6-71.2,0.2c0,0-52.4,34.7-40.9,71.4c0,0,2.1,23.5,35.5,54.9l26,26l-92.1,91.2c0,0-39.6-35.5-67.7,0c-28.1,35.5-12.9,47.1,7,68.5c19.8,21.5,129.2,130.9,129.2,130.9s33.8,22.3,59.4-6.6c31.3-34.2-5-66.5-5-66.5l94.1-92.3c0,0,29.5,30.6,60.4,56.7c33.4,28.2,75.5-16.7,97.5-48.3c22-31.6-12.7-64.4-12.7-64.4l-35-35l79.5-75.2l82.4,72.8l-43,44.2c0,0-31.4,41.3,8.7,79.7c0,0,47.9,53.3,86.3,20.6l56.1-51.2l93.7,92.1c0,0-37.2,33.9-6.2,66.1c31,32.2,59,10.3,70.6-2.1c11.6-12.4,135-137.5,135-137.5S1002.9,788.2,974.5,763.5z M424.8,773.5c14.2,15.5-9.9,32.2-9.9,32.2c-16.7,17.3-28.5,5-28.5,5S344.9,770.1,327,753c-18-17-35.9,1.6-35.9,1.6S205.3,841,178.6,865.7c-26.6,24.8-2.1,48.5-2.1,48.5l0,0L58,797.7c0,0,39.6,25.6,76-11.1c36.3-36.7,92.9-91.6,92.9-91.6s26-18.2-9.1-51.2c-35.1-33-43.8-45.8-43.8-45.8s-15.7-11.6,10.3-33c0,0,11.6-20.6,33,3.3l51,50.6l0,0c0,0,0.1,0.1,0.1,0.1l9.3,9.2l0.1-0.1C309.6,659.3,412.8,760.4,424.8,773.5z M517.7,586.8c-20.4-18-42.7,5.9-42.7,5.9l-86.7,80.2L308.8,594l80.3-87.7c0,0,21.5-18.2-25.2-56.6C317.3,411.3,113.3,228,113.3,228s-14-9.9-16.9-55.3c-2.9-45.4-6.6-102-6.6-102l123,12.4c0,0,21.1-0.8,28.9,9.9c7.8,10.7,238.6,269.6,238.6,269.6s27.7,29.7,61.1-23.5L755.7,98c0,0,9.9-15.3,34.7-15.7c24.8-0.4,123-9.9,123-9.9L901,195.8c0,0,2.9,23.1-41.3,55.3c-44.2,32.2-241.9,217.6-241.9,217.6s-25.6,17.7,0,46.6c25.6,28.9,73.9,78,73.9,78l-76.6,78.7C597.9,657,535.3,602.2,517.7,586.8z M815.1,926.1c0,0,29.3-36.3-9.5-74.7s-92.9-92.5-92.9-92.5s-20.2-26-44.6-0.4c-24.4,25.6-50.8,50-50.8,50s-14.9,17.3-33.8-5s-13.2-25.6,11.6-48.7c24.8-23.1,195.7-194,195.7-194s9.5-12,23.1,0s16.1,16.9,16.1,16.9s11.6,8.7-4.5,24.4s-57.8,58.2-57.8,58.2s-16.1,15.2,15.7,47.2l99.2,96.6c0.1,0.1,11.6,26.1,48.9,3.4L815.1,926.1z"/></g>
                    </svg>
                    <span id="jogador_total_partidas"></span>
                </div>
                <div class="info_item">
                    <div class="material-icons-outlined md-48">military_tech</div>
                    <span id="jogador_poisicao_rank"></span>
                </div>
                <div class="info_item">
                    <div class="material-icons-outlined md-48">emoji_events</div>
                    <span id="jogador_total_pontos"></span>
                </div>
            </div>
        </div>
        <div id="log_partidas">
            <div class="titulo_sessao">
                Histórico de batalhas
            </div>
            <div id="jogador_log_partidas_container">
                <!-- Conteúdo gerado -->
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js"
        integrity="sha512-/A6lxqQJVUIMnx8B/bx/ERfeuJnqoWPJdUxN8aBj+tZYL35O998ry7UUGoN65PSUNlJNrqKZrDENi4i1c3zy4Q=="
        crossorigin="anonymous"></script>
<script src="js/websocket/websocket.js?ver=3.0" type="text/javascript"></script>
<script src="js/mensagens.js?ver=3.0" type="text/javascript"></script>
<script src="js/comunicacao.js?ver=3.0" type="text/javascript"></script>
<script src="js/war/ranking.js?ver=3.0" type="text/javascript"></script>
<script src="js/war/perfil.js?ver=3.0" type="text/javascript"></script>

<script>
    _libwebsocketPerfil = new gpscheck.comunicacao.GPSWebSocket(8080);
    _perfil = new jogos.war.Perfil("#jogador_log_partidas_container");

    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = window.location.search.substring(1),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
        }
    };

    var perfil_enviarMsg = function (usuario) {
        const perfilMsg = comunicacao_perfil(usuario);
        _libwebsocketPerfil.enviarObjJson(perfilMsg);
    };

    var perfil_procurar = function (usuario) {
        if (!usuario) {
            usuario = $('#input_pesquisa').val() || getUrlParameter('usuario') || "";
        }
        $('#input_pesquisa').val("");
        $('#input_pesquisa').blur();

        window.location = '/perfil.html?usuario=' + usuario;
    };

    function posAberturaSocket(msg) {
        const usuario = $('#input_pesquisa').val() || getUrlParameter('usuario') || "";
        perfil_enviarMsg(usuario);
    }

    function posRecebimentoMensagemServidor(msg) {
        const jsonMensagem = JSON.parse(msg);
        if (jsonMensagem.tipo === TipoMensagem.perfil) {
            perfil_processaMsg(jsonMensagem.params);
        }
    }

    _libwebsocketPerfil.FOnOpen(posAberturaSocket);
    _libwebsocketPerfil.FOnMessage(posRecebimentoMensagemServidor);
    _libwebsocketPerfil.iniciar();

    $(document).on('keypress', function (e) {
        if (e.which === 13) {
            const usuario = $('#input_pesquisa').val() || getUrlParameter('usuario') || "";
            perfil_procurar(usuario);
        }
    });
</script>

</body>
</html>